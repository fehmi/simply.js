<template>
  <button>
    <slot></slot>
  </button>
</template>

<style>
  button {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    white-space: nowrap;
    border-radius: 0.375rem;
    font-size: 0.875rem;
    font-weight: 600;
    transition: all 0.2s ease;
    border: 1px solid transparent;
  }

  button:focus-visible {
    outline: none;
    box-shadow: 0 0 0 3px hsl(var(--foreground) / 0.50);
  }

  button:disabled {
    pointer-events: none;
    opacity: 0.5;
  }

  /* Default Variant */
  button[variant='default'] {
    background-color: hsl(var(--primary));
    color: hsl(var(--primary-foreground));
  }

  button[variant='default']:hover {
    background-color: hsl(var(--primary) / 0.9);
  }

  /* Destructive Variant */
  button[variant='destructive'] {
    background-color: hsl(var(--destructive));
    color: hsl(var(--destructive-foreground));
  }

  button[variant='destructive']:hover {
    background-color: hsl(var(--destructive) / 0.9);
  }

  /* Outline Variant */
  button[variant='outline'] {
    border: 1px solid hsl(var(--border));
    background-color: hsl(var(--background));
    color: hsl(var(--foreground));
  }

  button[variant='outline']:hover {
    background-color: hsl(var(--accent));
    color: hsl(var(--accent-foreground));
  }

  /* Secondary Variant */
  button[variant='secondary'] {
    background-color: hsl(var(--secondary));
    color: hsl(var(--secondary-foreground));
  }

  button[variant='secondary']:hover {
    background-color: hsl(var(--secondary) / 0.8);
  }

  /* Ghost Variant */
  button[variant='ghost'] {
    background-color: transparent;
    color: hsl(var(--foreground));
  }

  button[variant='ghost']:hover {
    background-color: hsl(var(--accent));
    color: hsl(var(--accent-foreground));
  }

  /* Link Variant */
  button[variant='link'] {
    color: hsl(var(--primary));
    background-color: transparent;
    text-decoration: underline;
    text-underline-offset: 4px;
  }

  button[variant='link']:hover {
    text-decoration-thickness: 2px;
  }

  /* Sizing */
  button[size='default'] {
    height: 2.5rem;
    padding-left: 1rem;
    padding-right: 1rem;
  }

  button[size='sm'] {
    height: 2.25rem;
    padding-left: 0.75rem;
    padding-right: 0.75rem;
  }

  button[size='lg'] {
    height: 2.75rem;
    padding-left: 2rem;
    padding-right: 2rem;
  }

  button[size='icon'] {
    height: 2.5rem;
    width: 2.5rem;
  }
</style>

<script>
  class SButton extends HTMLElement {
    constructor() {
      super();
      this.attachShadow({ mode: 'open' });
      const template = this.ownerDocument.querySelector('template');
      this.shadowRoot.appendChild(template.content.cloneNode(true));
    }

    connectedCallback() {
      this.updateButtonAttributes();
    }

    static get observedAttributes() {
      return ['variant', 'size', 'disabled'];
    }

    attributeChangedCallback(name, oldValue, newValue) {
      this.updateButtonAttributes();
    }

    updateButtonAttributes() {
      const button = this.shadowRoot.querySelector('button');
      if (!button) return;

      const variant = this.getAttribute('variant') || 'default';
      const size = this.getAttribute('size') || 'default';

      button.setAttribute('variant', variant);
      button.setAttribute('size', size);

      if (this.hasAttribute('disabled')) {
        button.setAttribute('disabled', '');
      } else {
        button.removeAttribute('disabled');
      }
    }
  }

  window.customElements.define('s-button2', SButton);
</script>